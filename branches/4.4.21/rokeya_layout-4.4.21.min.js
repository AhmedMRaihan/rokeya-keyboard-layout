function banglaLayout(e){var t=document.getElementById(e);var n=new Keyboard;try{t.onkeydown=function(e){var t=window.event||e;var r=t.srcElement||t.target;this.returnValue=n.handleKeyboardInput(t,r);return this.returnValue};t.onkeypress=function(e){return this.returnValue};t.onkeyup=function(e){if(!!e)e.preventDefault()}}catch(r){console.log(r.message)}}function Keyboard(){this.global=new GlobalVariable}function GlobalVariable(){this.bd=new Letter_Information;this.currentLanguage="bn_BD";this.replaceLastChar=false;this.ZWNJ="‌";this.ZWJ="‍";this.letterKeyMap=[["া","অ"],["ব","ঁ"],["চ","ছ"],["ড","দ"],["ে","এ"],["ফ","থ"],["গ","ঘ"],["","হ"],["ি","ই"],["জ","ঝ"],["ক","খ"],["ল","শ"],["ম","ঃ"],["ন","ণ"],["ো","ও"],["প","ফ"],["্","ঢ়"],["র","ড়"],["স","ষ"],["ট","ত"],["ু","উ"],["ভ","ং"],["ৃ","ধ"],["ঙ","ঞ"],["য়","্য"],["য","ৎ"]];this.numberKeyMap=["০","১","২","৩","৪","৫","৬","৭","৮","৯"]}function Letter_Information(){}Keyboard.prototype.handleKeyboardInput=function(e,t){this.textInputSource=t;this.oEvent=e;var n="",r="",i="",s="",o=this.textInputSource.value,u=0;var a=this.selectKeyPressed();if(!!a.iShouldDealIt==false)return true;if(this.global.currentLanguage=="en_US"){return true}if(a.placeTo>=2){r=o.charAt(a.placeTo-2);n=o.charAt(a.placeTo-1);u=this.global.bd.getFollower(n,1)}else if(a.placeTo==1){n=o.charAt(a.placeTo-1);u=this.global.bd.getFollower(n,1)}if(a.placeTo>=0&&a.placeTo<=this.textInputSource.value.length-2){s=this.textInputSource.value.charAt(a.placeTo+1);i=this.textInputSource.value.charAt(a.placeTo+0)}else if(a.placeTo>=0&&a.placeTo<=this.textInputSource.value.length-1)i=this.textInputSource.value.charAt(a.placeTo+0);a.replaceLastChar=a.replaceLastChar||n=="্"&&a.unicodeKey=="্";if(a.replaceLastChar){if(n=="্"&&a.unicodeKey=="্"){a.unicodeKey="+"}else if(n=="্"&&a.unicodeKey==""){a.unicodeKey="্"+this.global.ZWNJ}else if(u==2)a.unicodeKey=this.global.bd.getFollower(n,2);else if(u==7)a.unicodeKey=this.global.ZWNJ+this.global.bd.getFollower(n,2);else a.unicodeKey=this.global.bd.getFollower(n,2);if(a.unicodeKey.length>0){a.placeTo-=1;a.position.start-=1}}if(a.unicodeKey=="্য"&&n=="র"){a.position.start-=1;a.unicodeKey="র"+this.global.ZWNJ+"্"+"য"}if(n==a.unicodeKey&&(u==2||u==7)){var f=this.global.bd.getSwitchedLetter(a.unicodeKey);if(f.length>0){a.position.start-=1;a.unicodeKey=f}}else if(a.characterType==2&&!(u==1||u==3)){a.unicodeKey=this.global.bd.getFollower(a.unicodeKey,2)}if(n=="।"&&a.unicodeKey=="।"){a.unicodeKey=".";a.position.start-=1}if(a.code==8){a.position.start-=+(a.position.start==a.position.end);if(r=="্"||r==this.global.ZWNJ)a.position.start-=1;if(a.position.start<0)a.position.start=0}if(a.code==46){a.position.end+=+(a.position.start==a.position.end);a.position.end+=s=="্"?1:0}var l=o.slice(0,a.position.start);var c=o.slice(a.position.end);var h=l+a.unicodeKey+c;var p=a.position.start+a.unicodeKey.length;this.writeFinalValue(h,p);return false};Keyboard.prototype.selectKeyPressed=function(){var e=this.oEvent.keyCode||this.oEvent.which;var t=String.fromCharCode(this.oEvent.keyCode||this.oEvent.which);var n=this.cursorPosition();if(e==8||e==46){return{code:e,unicodeKey:"",iShouldDealIt:true,placeTo:n.start,position:n}}if(this.oEvent.ctrlKey||this.oEvent.altKey||e<32||e>=37&&e<=40){if(this.oEvent.ctrlKey&&e==77){var r=this.global.currentLanguage=="bn_BD"?"en_US":"bn_BD";this.global.currentLanguage=r}return{code:e,iShouldDealIt:false}}var i="";if(e>=65&&e<=90){i=this.global.letterKeyMap[e-65][+!!this.oEvent.shiftKey]}else if(e>=48&&e<=57&&this.oEvent.shiftKey==false){i=this.global.numberKeyMap[e-48][0]}else if(!window.opera&&e>=96&&e<=105&&this.oEvent.shiftKey==false)i=this.global.numberKeyMap[e-96][0];else if(e==52&&this.oEvent.shiftKey)i="৳";else if((e==190||e==110)&&!this.oEvent.shiftKey)i="।";else if(e==107&&this.oEvent.shiftKey)i=this.global.letterKeyMap[81-65][0];else if(!!document.selection&&!!document.selection.createRange&&e==187&&this.oEvent.shiftKey)i=this.global.letterKeyMap[81-65][0];else if((e==187||e==61)&&this.oEvent.shiftKey)i=this.global.letterKeyMap[81-65][0];else return{code:e,iShouldDealIt:false};var s=e==72&&!this.oEvent.shiftKey;return{code:e,iShouldDealIt:true,unicodeKey:i,shiftKeyPressed:this.oEvent.shiftKey,replaceLastChar:s,placeTo:n.start,position:n,characterType:this.global.bd.getFollower(i,1)}};Keyboard.prototype.writeFinalValue=function(e,t){var n=this.textInputSource.scrollTop;if(typeof this.textInputSource.selectionStart=="number"&&typeof this.textInputSource.selectionEnd=="number"){this.textInputSource.value=e}else if(document.selection&&document.selection.createRange){this.textInputSource.value=e}this.textInputSource.focus();this.textInputSource.scrollTop=n;if(this.textInputSource.setSelectionRange){this.textInputSource.focus();this.textInputSource.setSelectionRange(t,t)}else if(this.textInputSource.createTextRange){var r=this.textInputSource.createTextRange();r.collapse(true);r.moveEnd("character",t);r.moveStart("character",t);r.select()}};Keyboard.prototype.cursorPosition=function(){var e=0,t=0;if(typeof this.textInputSource.selectionStart=="number"&&typeof this.textInputSource.selectionEnd=="number"){e=this.textInputSource.selectionStart;t=this.textInputSource.selectionEnd}else if(document.selection&&document.selection.createRange&&this.textInputSource.type=="textarea"){var n=this.textInputSource;n.focus();var r=document.selection.createRange().duplicate();if(r.parentElement()==n&&this.textInputSource.type=="textarea"){var i=document.body.createTextRange();i.moveToElementText(n);i.setEndPoint("EndToStart",r);var s=document.body.createTextRange();s.moveToElementText(n);s.setEndPoint("StartToEnd",r);var o=false,u=false,a=false;var f,l,c,h,p,d;f=l=i.text;c=h=r.text;p=d=s.text;do{if(!o){if(i.compareEndPoints("StartToEnd",i)==0){o=true}else{i.moveEnd("character",-1);if(i.text==f){l+="\r\n"}else{o=true}}}if(!u){if(r.compareEndPoints("StartToEnd",r)==0){u=true}else{r.moveEnd("character",-1);if(r.text==c){h+="\r\n"}else{u=true}}}if(!a){if(s.compareEndPoints("StartToEnd",s)==0){a=true}else{s.moveEnd("character",-1);if(s.text==p){d+="\r\n"}else{a=true}}}}while(!o||!u||!a);var v=l+h+d;var m=false;if(n.value==v){m=true}var e=l.length;var t=e+r.text.length;if(t!=e)t+=e-t}}else if(document.selection&&document.selection.createRange){var g=document.selection.createRange();var y=this.textInputSource.createTextRange();var b=this.textInputSource.createTextRange();var w=g.getBookmark();y.moveToBookmark(w);b.setEndPoint("EndToStart",y);e=b.text.length;t=e+g.text.length}return{start:e,end:t}};Letter_Information.prototype.switchedLetter=[["অ",""],["া","আ"],["ে","ৈ"],["এ","ঐ"],["ো","ৌ"],["ও","ঔ"],["ি","ী"],["ই","ঈ"],["ু","ূ"],["উ","ঊ"],["ৃ","ঋ"],["্","+"]];Letter_Information.prototype.getSwitchedLetter=function(e){var t=0;for(;t<this.switchedLetter.length;++t){if(this.switchedLetter[t][0]==e){return this.switchedLetter[t][1]}}return""};Letter_Information.prototype.letter_info=[["‍",5,""],["।",1,"."],["ঁ",6,""],["ং",6,""],["ঃ",6,""],["অ",7,"অ"],["আ",7,"া"],["ই",7,"ি"],["ঈ",7,"ী"],["উ",7,"ু"],["ঊ",7,"ূ"],["ঋ",7,"ৃ"],["এ",7,"ে"],["ঐ",7,"ৈ"],["ও",7,"ো"],["ঔ",7,"ৌ"],["ক",1,"খ"],["খ",1,""],["গ",1,"ঘ"],["ঘ",1,""],["ঙ",1,""],["চ",1,"ছ"],["ছ",1,""],["জ",1,"ঝ"],["ঝ",1,""],["ঞ",1,""],["ট",1,"ঠ"],["ঠ",1,""],["ড",1,"ঢ"],["ঢ",1,""],["ণ",3,""],["ত",1,"থ"],["থ",1,""],["দ",1,"ধ"],["ধ",1,""],["ন",1,""],["প",1,"ফ"],["ফ",1,""],["ব",3,"ভ"],["ভ",1,""],["ম",1,""],["য",3,""],["র",3,"ড়"],["ল",1,""],["শ",1,""],["ষ",1,""],["স",1,"শ"],["হ",1,""],["া",2,"আ"],["ি",2,"ই"],["ী",2,"ঈ"],["ু",2,"উ"],["ূ",2,"ঊ"],["ৃ",2,"ঋ"],["ে",2,"এ"],["ৈ",2,"ঐ"],["ো",2,"ও"],["ৌ",2,"ঔ"],["্",4,"্"],["ৎ",6,""],["ৗ",2,"ঈ"],["ড়",1,"ঢ়"],["ঢ়",1,""],["য়",1,""],["৳",6,"$"],["৷",1,"."],["৻",1,""],["ৼ",1,""]];Letter_Information.prototype.getFollower=function(e,t){var n=0;var r=this.letter_info.length-1;var i=Math.floor((r+n)/2);for(;r>=n;i=Math.floor((r+n)/2)){if(this.letter_info[i][0]==e)return this.letter_info[i][t];if(this.letter_info[i][0]>e)r=i-1;else n=i+1}return""}